<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <title>CTC Market Update Map</title>
  <meta name="viewport" content="initial-scale=1,maximum-scale=1,user-scalable=no" />
  <link href="https://api.mapbox.com/mapbox-gl-js/v2.15.0/mapbox-gl.css" rel="stylesheet" />
  <link rel="stylesheet" href="styles.css"> <!-- Link to external CSS -->
  <script src="https://api.mapbox.com/mapbox-gl-js/v2.15.0/mapbox-gl.js"></script>
  <style>
    /* Map container */
    #map {
      position: absolute;
      top: 0;
      bottom: 0;
      width: 100%;
    }
  </style>
</head>
<body>

<div id="map"></div>

<script>
  document.addEventListener('DOMContentLoaded', () => {
    if (!mapboxgl.supported()) {
      alert('Your browser does not support Mapbox GL JS.');
      return;
    }

    const accessToken = 'pk.eyJ1IjoicnRhbWF5bzciLCJhIjoiY2x0MHN2aXNvMHEzZDJxcXl0ZGdyem12biJ9.jFqQ8YQsP77PJtxgaBhuIg';
    mapboxgl.accessToken = accessToken;

    // Default settings for desktop, tablet, and mobile
    const settings = {
      desktop: {
        default: {
          center: [-82.1, 26.3], // Default center for desktop
          zoom: 7.4 // Default zoom for desktop
        },
        layers: {
          state: { center: [-86.3, 28.2], zoom: 5.8 },
          metro: { center: [-82.1, 26.3], zoom: 7.4 },
          county: { center: [-82.1, 26.3], zoom: 7.4 },
          city: { center: [-82.1, 26.3], zoom: 7.4 },
          zip: { center: [-82.1, 26.3], zoom: 7.4 }
        }
      },
      tablet: {
        default: {
          center: [-82.5, 26.0], // Default center for tablet
          zoom: 6.8 // Default zoom for tablet
        },
        layers: {
          state: { center: [-87.5, 27.5], zoom: 5.8 },
          metro: { center: [-82, 26.0], zoom: 6.8 },
          county: { center: [-82, 26.0], zoom: 6.8 },
          city: { center: [-82, 26.0], zoom: 6.8 },
          zip: { center: [-82.5, 26.0], zoom: 6.8 }
        }
      },
      mobile: {
        default: {
          center: [-82.3, 25.8], // Default center for mobile
          zoom: 6.2 // Default zoom for mobile
        },
        layers: {
          state: { center: [-87.3, 27.3], zoom: 5.5 },
          metro: { center: [-82, 25.8], zoom: 6.2 },
          county: { center: [-82, 25.8], zoom: 6.2 },
          city: { center: [-82, 25.8], zoom: 6.2 },
          zip: { center: [-82.3, 25.8], zoom: 6.2 }
        }
      }
    };

    // Detect screen size and apply appropriate settings
    function getDeviceSettings() {
      const screenWidth = window.innerWidth;

      if (screenWidth > 1024) {
        // Desktop
        return settings.desktop;
      } else if (screenWidth > 768) {
        // Tablet
        return settings.tablet;
      } else {
        // Mobile
        return settings.mobile;
      }
    }

    // Get the appropriate settings based on the device
    const deviceSettings = getDeviceSettings();

    // Initialize the map with the default settings for the device
    const map = new mapboxgl.Map({
      container: 'map',
      style: 'mapbox://styles/rtamayo7/cm8sape5r00jc01s354wd73jd',
      center: deviceSettings.default.center,
      zoom: deviceSettings.default.zoom
    });

    // Add zoom controls (Desktop Only)
    const nav = new mapboxgl.NavigationControl();
    map.addControl(nav, 'top-right');

    // Add scale control
    const scale = new mapboxgl.ScaleControl({
      maxWidth: 100,
      unit: 'imperial'
    });
    map.addControl(scale, 'bottom-right');

    // Function to update the map based on the selected layer
    function updateMapForLayer(layer) {
      const layerSettings = deviceSettings.layers[layer];
      if (layerSettings) {
        map.flyTo({
          center: layerSettings.center,
          zoom: layerSettings.zoom
        });
      }
    }

    // Example: Update the map when a layer is selected
    // Replace this with your actual layer toggle logic
    document.addEventListener('keydown', (e) => {
      if (e.key === '1') updateMapForLayer('state');
      if (e.key === '2') updateMapForLayer('metro');
      if (e.key === '3') updateMapForLayer('county');
      if (e.key === '4') updateMapForLayer('city');
      if (e.key === '5') updateMapForLayer('zip');
    });

    // Update map settings dynamically when the screen is resized
    window.addEventListener('resize', () => {
      const newDeviceSettings = getDeviceSettings();
      map.flyTo({
        center: newDeviceSettings.default.center,
        zoom: newDeviceSettings.default.zoom
      });
    });
  });
</script>

</body>
</html>